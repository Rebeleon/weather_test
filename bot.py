import telebot
import requests
from config import bot_token, api_url

bot = telebot.TeleBot(bot_token)


@bot.message_handler(commands=['start'])
def start(message):

    bot.send_message(message.from_user.id, "üëã –ü—Ä–∏–≤–µ—Ç! –ù–∞–ø–∏—à–∏ –≥–æ—Ä–æ–¥ –∏ —è –Ω–∞–ø–∏—à—É –ø–æ–≥–æ–¥—É —Å–µ–π—á–∞—Å!")


@bot.message_handler(content_types=['text'])
def get_text_messages(message):
    city = message.text
    params = {'city': city}

    response = requests.get(api_url, params=params)
    if response.status_code == 200:
        weather_data = response.json()

        message_ = f"–ü–æ–≥–æ–¥–∞ –≤ –≥–æ—Ä–æ–¥–µ {city}:\n"
        message_ += f"–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: {weather_data['temperature']}¬∞C\n"
        message_ += f"–ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ: {weather_data['pressure']} –º–º —Ä—Ç.—Å—Ç.\n"
        message_ += f"–°–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞: {weather_data['wind_speed']} –º/—Å"
        bot.send_message(message.from_user.id, message_)

    else:
        bot.send_message(message.from_user.id, '–¢–∞–∫–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –Ω–µ—Ç')


bot.polling(none_stop=True, interval=0)
